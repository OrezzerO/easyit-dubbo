# 启动分析

## 服务端启动分析

### 服务端配置

启动服务端的时候,
会将一些信息[注入](../dubbo-demo/dubbo-demo-api/dubbo-demo-api-provider/src/main/java/org/apache/dubbo/demo/provider/Application.java#L43)
到 DubboBootstrap 中.
包括注册中心地址, ServiceConfig 等.

问题: Model 组件是干什么的?

当调用 [start](../dubbo-demo/dubbo-demo-api/dubbo-demo-api-provider/src/main/java/org/apache/dubbo/demo/provider/Application.java#L53)
方法时, Dubbo服务开始启动.

[start 方法调用 ApplicationDeployer 的start 方法进行异步启动](../dubbo-config/dubbo-config-api/src/main/java/org/apache/dubbo/config/bootstrap/DubboBootstrap.java#L224):

* [onStarting](../dubbo-config/dubbo-config-api/src/main/java/org/apache/dubbo/config/deploy/DefaultApplicationDeployer.java#L573)
  方法将 applicationDeployer 自身状态改为 starting, 然后准备一个新的 startFuture

* [initialize](../dubbo-config/dubbo-config-api/src/main/java/org/apache/dubbo/config/deploy/DefaultApplicationDeployer.java#L575)
  会做一些初始化工作, 包括:
    1. [注册 ShutdownHook](../dubbo-config/dubbo-config-api/src/main/java/org/apache/dubbo/config/deploy/DefaultApplicationDeployer.java#L191)
    2. [启动 ConfigCenter](../dubbo-config/dubbo-config-api/src/main/java/org/apache/dubbo/config/deploy/DefaultApplicationDeployer.java#L193)
    3. [加载应用配置](../dubbo-config/dubbo-config-api/src/main/java/org/apache/dubbo/config/deploy/DefaultApplicationDeployer.java#L195)
    4. [初始化模块级别 deployer](../dubbo-config/dubbo-config-api/src/main/java/org/apache/dubbo/config/deploy/DefaultApplicationDeployer.java#L197)
    5. [启动元数据中心](../dubbo-config/dubbo-config-api/src/main/java/org/apache/dubbo/config/deploy/DefaultApplicationDeployer.java#L200)

* [doStart](../dubbo-config/dubbo-config-api/src/main/java/org/apache/dubbo/config/deploy/DefaultApplicationDeployer.java#L577)
  方法会启动各个模块的 deployer

在模块启动的时候,
首先[检查 ApplicationDeployer 是否初始化完成](../dubbo-config/dubbo-config-api/src/main/java/org/apache/dubbo/config/deploy/DefaultModuleDeployer.java#L137),
然后做模块的启动动作:

* [onModuleStarting](../dubbo-config/dubbo-config-api/src/main/java/org/apache/dubbo/config/deploy/DefaultModuleDeployer.java#L152): 改变自身状态, 并通知 applicationDeployer
* [初始化](../dubbo-config/dubbo-config-api/src/main/java/org/apache/dubbo/config/deploy/DefaultModuleDeployer.java#L155): [计算是否需要异步 export 或者异步 refer](../dubbo-config/dubbo-config-api/src/main/java/org/apache/dubbo/config/deploy/DefaultModuleDeployer.java#L117)
* [暴露服务](../dubbo-config/dubbo-config-api/src/main/java/org/apache/dubbo/config/deploy/DefaultModuleDeployer.java#L158) 
* [构造引用](../dubbo-config/dubbo-config-api/src/main/java/org/apache/dubbo/config/deploy/DefaultModuleDeployer.java#L167)
